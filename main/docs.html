<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal Search</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a1a;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            overflow: hidden;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 3px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .main-content-area {
            background-color: #ffffff;
            border-radius: 0 12px 12px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            color: #333;
            position: relative;
        }

        .webpage-iframe {
            width: 100%;
            height: 100%;
            border: none;
            position: absolute;
            top: 0;
            left: 0;
            display: none;
        }

        .webpage-iframe.active {
            display: block;
        }

        @media (max-width: 768px) {
            body {
                flex-direction: column;
                padding: 0;
            }
            .browser-container {
                flex-direction: column;
                width: 100vw;
                height: 100vh;
                border-radius: 0;
            }
            .sidebar {
                width: 100%;
                height: auto;
                max-height: 40vh;
                margin-right: 0;
                border-radius: 0;
                padding-bottom: 10px;
            }
            .main-content-area {
                width: 100%;
                height: 60vh;
                border-radius: 0;
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100">
    <div class="browser-container flex w-screen h-screen rounded-none shadow-2xl overflow-hidden">
        <div class="sidebar bg-[#21212c] w-64 p-4 flex flex-col rounded-l-xl custom-scrollbar overflow-y-auto">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center space-x-2">
                    <div class="w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold" style="background: linear-gradient(to bottom right, #6246ea, #9d4edd);">A</div>
                    <span class="text-sm font-semibold text-gray-100">User</span>
                </div>
                <button id="newTabButton" class="p-1 rounded-md hover:bg-[#33354a] transition-colors">
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                </button>
            </div>

      
<script src="uv/uv.bundle.js" defer></script>
                <script src="uv/uv.config.js" defer></script>
                <script src="register-sw.js" defer></script>
                <script src="search.js" defer></script>
                <script src="index.js" defer></script>
            <div class="mb-4">
                <h3 class="text-xs font-semibold text-gray-400 uppercase mb-2">Home</h3>
                <div class="space-y-1">
                    <div id="homeTab" class="flex items-center p-2 rounded-md text-white cursor-pointer transition-colors" style="background: linear-gradient(to right, #6246ea, #9d4edd);" data-url="">
                        <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 2a8 8 0 100 16 8 8 0 000-16zM8.707 9.293a1 1 0 00-1.414 1.414L10 12.414l2.707-2.707a1 1 0 00-1.414-1.414L10 10.586l-1.293-1.293z" clip-rule="evenodd"></path></svg>
                        <span class="text-sm">Home</span>
                    </div>
                </div>
            </div>

            <div class="flex-grow mb-4">
                <h3 class="text-xs font-semibold text-gray-400 uppercase mb-2">Today</h3>
                <div id="todayTabsContainer" class="space-y-1">
                    </div>
            </div>
<a href="index.html">
            <div class="mt-auto space-y-1">
                <div class="flex items-center p-2 rounded-md hover:bg-[#33354a] cursor-pointer transition-colors">
                    <svg class="w-5 h-5 mr-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                    <span class="text-sm text-gray-300">Home</span>
                </div>
                </a>
                <div class="flex items-center p-2 rounded-md hover:bg-[#33354a] cursor-pointer transition-colors">
                    <svg class="w-5 h-5 mr-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                    <span class="text-sm text-gray-300">Partners</span>
                </div>
                <div class="flex items-center p-2 rounded-md hover:bg-[#33354a] cursor-pointer transition-colors">
                    <svg class="w-5 h-5 mr-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                    <span class="text-sm text-gray-300">Settings</span>
                </div>
            </div>
        </div>

        <div class="main-content-area flex-grow" id="iframeContainer">
            </div>
    </div>

    <script>
     

        const newTabButton = document.getElementById('newTabButton');
        const uvAddressInput = document.getElementById('uv-address');
        const iframeContainer = document.getElementById('iframeContainer');
        const todayTabsContainer = document.getElementById('todayTabsContainer');
        const homeTab = document.getElementById('homeTab');
        const uvForm = document.getElementById('uv-form');

        let tabs = [];
        let activeTabId = '';

        let uv;
        async function initializeUV() {
            if (typeof Ultraviolet !== 'undefined') {
                uv = new Ultraviolet.Ultraviolet();
            } else {
                console.warn("Ultraviolet object not found. Ensure uv.bundle.js is loaded correctly, especially if embed.html depends on it.");
            }
        }
        initializeUV();


        function generateUniqueId() {
            return '_' + Math.random().toString(36).substr(2, 9);
        }

        function getFaviconUrl(url) {
            try {
                let parsedUrl;
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    parsedUrl = new URL(`https://${url}`);
                } else {
                    parsedUrl = new URL(url);
                }
                return `https://www.google.com/s2/favicons?domain=${parsedUrl.hostname}`;
            } catch (e) {
                return 'https://placehold.co/16x16/000000/FFFFFF?text=?';
            }
        }

        function updateTabActiveState(tabElement, isActive) {
            if (isActive) {
                tabElement.classList.remove('hover:bg-[#33354a]');
                tabElement.classList.add('bg-[#33354a]');
            } else {
                tabElement.classList.remove('bg-[#33354a]');
                tabElement.classList.add('hover:bg-[#33354a]');
            }
        }

        function loadTab(tabId) {
            activeTabId = tabId;

            document.querySelectorAll('.webpage-iframe').forEach(iframe => {
                iframe.classList.remove('active');
            });

            const selectedTab = tabs.find(tab => tab.id === tabId);
            if (selectedTab) {
                const targetIframe = document.getElementById(`iframe-${tabId}`);
                if (targetIframe) {
                    targetIframe.classList.add('active');
                }
            } else if (tabId === 'home') {
                const homeIframe = document.getElementById('iframe-home');
                if (homeIframe) {
                    homeIframe.classList.add('active');
                } else {
                    addTab('https://ghoogle.org/', 'Home', 'home');
                }
            }

            document.querySelectorAll('.tab-item').forEach(tabEl => {
                updateTabActiveState(tabEl, tabEl.dataset.tabId === activeTabId);
            });

            if (homeTab) {
                if (tabId === 'home') {
                    homeTab.style.background = 'linear-gradient(to right, #6246ea, #9d4edd)';
                } else {
                    homeTab.style.background = '';
                    homeTab.classList.remove('bg-[#33354a]');
                    homeTab.classList.add('hover:bg-[#33354a]');
                }
            }
        }

        function addTab(rawUrl, title = 'New Tab', customTabId = null) {
            const tabId = customTabId || generateUniqueId();
            
            let fullUrl = rawUrl;
            if (!rawUrl.startsWith('http://') && !rawUrl.startsWith('https://')) {
                fullUrl = `https://${rawUrl}`;
            }

            const embeddedUrl = `placebareurlhere?url=${encodeURIComponent(fullUrl)}`;

            const newTab = { id: tabId, title: title, url: fullUrl, embeddedUrl: embeddedUrl };

            const existingTabIndex = tabs.findIndex(tab => tab.id === tabId);
            if (existingTabIndex > -1) {
                tabs[existingTabIndex] = newTab;
            } else {
                tabs.push(newTab);
            }

            let webpageFrame = document.getElementById(`iframe-${tabId}`);
            if (!webpageFrame) {
                webpageFrame = document.createElement('iframe');
                webpageFrame.id = `iframe-${tabId}`;
                webpageFrame.classList.add('webpage-iframe');
                iframeContainer.appendChild(webpageFrame);
            }
            webpageFrame.src = embeddedUrl;

            let tabElement = document.querySelector(`[data-tab-id="${tabId}"]`);
            if (!tabElement) {
                tabElement = document.createElement('div');
                tabElement.dataset.tabId = tabId;
                tabElement.classList.add('flex', 'items-center', 'p-2', 'rounded-md', 'cursor-pointer', 'transition-colors', 'tab-item');
                tabElement.innerHTML = `
                    <img src="${getFaviconUrl(fullUrl)}" alt="Favicon" class="w-4 h-4 mr-2 rounded-sm">
                    <span class="text-sm text-gray-300 flex-grow">${title}</span>
                    <button class="close-tab-button p-1 rounded-md hover:bg-red-500 transition-colors ml-2">
                        <svg class="w-3 h-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                `;

                tabElement.addEventListener('click', (event) => {
                    if (!event.target.closest('.close-tab-button')) {
                        loadTab(tabId);
                    }
                });

                const closeButton = tabElement.querySelector('.close-tab-button');
                closeButton.addEventListener('click', (event) => {
                    event.stopPropagation();
                    removeTab(tabId);
                });

                todayTabsContainer.appendChild(tabElement);
            }
            
            loadTab(tabId);
        }

        function removeTab(tabId) {
            const tabIndex = tabs.findIndex(tab => tab.id === tabId);
            if (tabIndex > -1) {
                tabs.splice(tabIndex, 1);
                
                const tabElement = document.querySelector(`[data-tab-id="${tabId}"]`);
                if (tabElement) {
                    tabElement.remove();
                }

                const iframeToRemove = document.getElementById(`iframe-${tabId}`);
                if (iframeToRemove) {
                    iframeToRemove.remove();
                }

                if (activeTabId === tabId) {
                    if (tabs.length > 0) {
                        loadTab(tabs[0].id);
                    } else {
                        loadTab('home');
                    }
                }
            }
        }

        function handleSearchSubmit() {
            let url = uvAddressInput.value.trim();
            if (url) {
                const displayTitle = url.replace(/^(https?:\/\/)?(www\.)?/, '').split('/')[0] || 'New Tab';
                addTab(url, displayTitle);
                uvAddressInput.value = '';
            }
        }

        newTabButton.addEventListener('click', () => {
            addTab('replacewithbare', 'New Tab');
        });

        if (homeTab) {
            homeTab.dataset.tabId = 'home';
            homeTab.addEventListener('click', () => {
                loadTab('home');
            });
            addTab('replacewithbare', 'Home', 'home');
        } else {
            addTab('relpacewithbare', 'Home', 'home');
        }
    </script>
</body>
</html>